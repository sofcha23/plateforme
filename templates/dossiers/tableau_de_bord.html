<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Tableau de Bord Admin - {{ utilisateur.service }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">
    <h1>Tableau de Bord - {{ utilisateur.service.nom }}</h1>
    <p>Connecté en tant que <strong>{{ utilisateur.username }}</strong></p>

    <!-- Cartes de Statistiques -->
    <div class="row mb-4">
        <div class="col-md-2">
            <div class="card text-white bg-primary">
                <div class="card-body text-center">
                    <h5>{{ stats.total }}</h5>
                    <small>Total</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card text-white bg-secondary">
                <div class="card-body text-center">
                    <h5>{{ stats.en_attente }}</h5>
                    <small>En Attente</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card text-white bg-info">
                <div class="card-body text-center">
                    <h5>{{ stats.en_cours }}</h5>
                    <small>En Cours</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card text-white bg-success">
                <div class="card-body text-center">
                    <h5>{{ stats.termines }}</h5>
                    <small>Terminés</small>
                </div>
            </div>
        </div>
        <div class="col-md-2">
            <div class="card text-white bg-danger">
                <div class="card-body text-center">
                    <h5>{{ stats.en_retard }}</h5>
                    <small>En Retard</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Liste des dossiers urgents -->
    <h3>Dossiers Requérant Attention</h3>
    <table class="table table-sm table-hover">
        <thead>
            <tr>
                <th>Code</th>
                <th>Statut</th>
                <th>Date limite</th>
                <th>Assigné à</th>
            </tr>
        </thead>
        <tbody>
            {% for dossier in dossiers_urgents %}
            <tr class="{% if dossier.est_en_retard %}table-danger{% endif %}">
                <td>{{ dossier.code }}</td>
                <td>{{ dossier.get_statut_display }}</td>
                <td>{{ dossier.date_limite }}</td>
                <td>{{ dossier.assigne_a }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">Aucun dossier urgent</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="mt-3">
        <a href="{% url 'liste_dossiers' %}" class="btn btn-outline-primary">Voir tous les dossiers</a>
        <a href="/admin/" class="btn btn-outline-secondary">Admin Django</a>
    </div>
</body>
</html>